# Claude TriFlow è‡ªåŠ¨åŒ–ç³»ç»Ÿ - å¿«é€ŸæŒ‡å—

## ç³»ç»Ÿæ¶æ„

```
Python ç›‘æ§è„šæœ¬ (python_activator.py)
  â””â”€ è½»é‡çº§ç›‘æ§ï¼Œæ£€æµ‹ Worker åœæ­¢
  â””â”€ Worker åœæ­¢ â†’ æ¿€æ´»ä¸´æ—¶ Brain

Brain (ä¸´æ—¶ä¼šè¯ï¼ŒæŒ‰éœ€æ¿€æ´»)
  â”œâ”€ è¯»å– tasks.md + task_state.json
  â”œâ”€ è¯»å– Worker è¾“å‡º
  â”œâ”€ è¯†åˆ«çŠ¶æ€å¹¶å‘é€å‘½ä»¤
  â”œâ”€ ä»»åŠ¡å®Œæˆåå‘é€ä¸‹ä¸€ä¸ªä»»åŠ¡
  â””â”€ å¤„ç†å®Œæˆåç«‹å³é€€å‡º

Worker (claude-worker)
  â””â”€ æ‰§è¡Œä»»åŠ¡ï¼Œè¾“å‡ºç»“æœ
```

## æ ¸å¿ƒä¼˜åŠ¿

âœ… **Brain é›¶ä¸Šä¸‹æ–‡ç§¯ç´¯**
   - æ¯æ¬¡æŒ‰éœ€æ¿€æ´»æ–°ä¼šè¯
   - å¤„ç†å®Œç«‹å³é€€å‡º
   - åªè¯»å–å¿…è¦ä¿¡æ¯

âœ… **ä»»åŠ¡è‡ªåŠ¨æµè½¬**
   - Brain æ£€æµ‹ä»»åŠ¡å®Œæˆ
   - è‡ªåŠ¨å‘é€ä¸‹ä¸€ä¸ªä»»åŠ¡
   - æ— éœ€äººå·¥å¹²é¢„

âœ… **æ™ºèƒ½çŠ¶æ€è¯†åˆ«**
   - ä¼˜å…ˆè¯†åˆ«å‘½ä»¤æç¤ºï¼ˆType /run, Type /clearï¼‰
   - å¤‡ç”¨æ™ºèƒ½åˆ¤æ–­
   - é˜²æ­¢è¯¯æ¿€æ´»

---

## å¿«é€Ÿå¯åŠ¨

### æ­¥éª¤ 1: å‡†å¤‡ä»»åŠ¡æ–‡ä»¶

ç¼–è¾‘ `tasks.md`ï¼š

```markdown
# Claude TriFlow ä»»åŠ¡åˆ—è¡¨

## Task 1: åˆ—å‡º Python æ–‡ä»¶
åˆ—å‡ºå½“å‰é¡¹ç›®ç›®å½•ä¸‹çš„æ‰€æœ‰ .py æ–‡ä»¶ï¼Œç»Ÿè®¡æ€»æ•°ã€‚

## Task 2: æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯
è¿è¡Œå‘½ä»¤æŸ¥çœ‹ Python ç‰ˆæœ¬å’Œå½“å‰å·¥ä½œç›®å½•ã€‚

## Task 3: åˆ›å»ºæµ‹è¯•æ–‡ä»¶
åˆ›å»ºä¸€ä¸ªåä¸º test_example.txt çš„æ–‡ä»¶ï¼Œå†™å…¥å½“å‰æ—¶é—´ã€‚
```

**æ³¨æ„**ï¼š
- ä»»åŠ¡æ ‡é¢˜æ ¼å¼ï¼š`## Task N: æ ‡é¢˜`
- N å¿…é¡»ä» 1 å¼€å§‹é€’å¢
- æ¯ä¸ªä»»åŠ¡åè·Ÿæè¿°å†…å®¹

### æ­¥éª¤ 2: ä¸€é”®å¯åŠ¨

```bash
./start_auto.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. æ£€æŸ¥ä¾èµ–ï¼ˆtmux, claude, python3ï¼‰
2. åˆå§‹åŒ–çŠ¶æ€æ–‡ä»¶ï¼ˆtask_state.jsonï¼‰
3. å¯åŠ¨ Worker ä¼šè¯
4. å¯åŠ¨ Python ç›‘æ§è„šæœ¬
5. Python æ¿€æ´» Brain å‘é€ç¬¬ä¸€ä¸ªä»»åŠ¡
6. è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡

### æ­¥éª¤ 3: è§‚å¯Ÿæ‰§è¡Œ

**æŸ¥çœ‹ Worker çŠ¶æ€ï¼š**
```bash
tmux attach -t claude-worker
# æŒ‰ Ctrl+B, D åˆ†ç¦»
```

**å®æ—¶æŸ¥çœ‹ç»“æœï¼š**
```bash
tail -f task_results.md
```

**æŸ¥çœ‹å½“å‰çŠ¶æ€ï¼š**
```bash
cat task_state.json
```

---

## å·¥ä½œæµç¨‹è¯¦è§£

### åˆå§‹åŒ–

```
1. start_auto.sh å¯åŠ¨
2. åˆå§‹åŒ– task_state.jsonï¼ˆè¯»å– tasks.md ç»Ÿè®¡ä»»åŠ¡æ•°ï¼‰
3. å¯åŠ¨ Worker ä¼šè¯
4. å¯åŠ¨ Python ç›‘æ§è„šæœ¬
5. Python ç¬¬ä¸€æ¬¡æ¿€æ´» Brain
6. Brain å‘é€ç¬¬ä¸€ä¸ªä»»åŠ¡ç»™ Worker
7. Brain é€€å‡º
8. Worker å¼€å§‹æ‰§è¡Œ
```

### ä¸»å¾ªç¯

```
å¾ªç¯ï¼š
  Python æ¯ 3 ç§’æ£€æµ‹ Worker è¾“å‡º

  å¦‚æœæ£€æµ‹åˆ° Worker åœæ­¢ï¼ˆæ—  "esc to interrupt"ï¼‰ï¼š
    â”œâ”€ æ¿€æ´»ä¸´æ—¶ Brain ä¼šè¯
    â”œâ”€ Brain è¯»å– Worker æœ€è¿‘ 20 è¡Œè¾“å‡º
    â”œâ”€ Brain è¯†åˆ«çŠ¶æ€ï¼š
    â”‚   â”œâ”€ "Type /run" â†’ å‘é€ /run
    â”‚   â”œâ”€ "Type /clear" â†’ å‘é€ /clear
    â”‚   â”œâ”€ "(y/n)" â†’ å‘é€ y
    â”‚   â”œâ”€ é€‰æ‹©é¢˜ â†’ å‘é€ 1
    â”‚   â””â”€ å…¶ä»– â†’ æ™ºèƒ½åˆ¤æ–­
    â”‚
    â”œâ”€ å¦‚æœä»»åŠ¡å®Œæˆï¼š
    â”‚   â”œâ”€ æ›´æ–° task_state.json
    â”‚   â”œâ”€ å‘é€ä¸‹ä¸€ä¸ªä»»åŠ¡ /plan Task N...
    â”‚   â””â”€ æˆ–æ ‡è®°æ‰€æœ‰ä»»åŠ¡å®Œæˆ
    â”‚
    â””â”€ Brain é€€å‡º

  Python ç»§ç»­ç›‘æ§...
```

### ä»»åŠ¡å®Œæˆ

```
1. Brain æ£€æµ‹åˆ° "All complete"
2. å‘é€ /clear æ¸…ç† Worker
3. è¯»å–ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼ˆTask N+1ï¼‰
4. å‘é€ /plan Task N+1...
5. æ›´æ–° task_state.json
6. Brain é€€å‡º
7. Worker å¼€å§‹æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡
...
æ‰€æœ‰ä»»åŠ¡å®Œæˆåï¼ŒPython è„šæœ¬è‡ªåŠ¨é€€å‡º
```

---

## æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | ä½œç”¨ |
|------|------|
| `tasks.md` | ä»»åŠ¡åˆ—è¡¨ï¼ˆç”¨æˆ·ç¼–è¾‘ï¼‰ |
| `task_state.json` | ä»»åŠ¡çŠ¶æ€ï¼ˆè‡ªåŠ¨ç”Ÿæˆå’Œæ›´æ–°ï¼‰ |
| `task_results.md` | æ‰§è¡Œç»“æœï¼ˆBrain è¿½åŠ ï¼‰ |
| `brain_controller_prompt.md` | Brain æ§åˆ¶å™¨æç¤ºè¯ |
| `python_activator.py` | Python ç›‘æ§æ¿€æ´»è„šæœ¬ |
| `init_state.sh` | çŠ¶æ€æ–‡ä»¶åˆå§‹åŒ–è„šæœ¬ |
| `start_auto.sh` | ä¸€é”®å¯åŠ¨è„šæœ¬ |

---

## çŠ¶æ€æ–‡ä»¶æ ¼å¼

**task_state.json**

```json
{
  "current_task": 2,
  "total_tasks": 5,
  "status": "in_progress",
  "last_update": "2025-01-21 14:30:25"
}
```

- `current_task`: å½“å‰æ‰§è¡Œçš„ä»»åŠ¡ç¼–å·
- `total_tasks`: æ€»ä»»åŠ¡æ•°
- `status`: çŠ¶æ€ï¼ˆinit, in_progress, all_completeï¼‰
- `last_update`: æœ€åæ›´æ–°æ—¶é—´

---

## TriFlow å·¥ä½œæµç†è§£

å…¸å‹çš„ TriFlow ä»»åŠ¡æµç¨‹ï¼š

```
1. /plan Task â†’ ç”Ÿæˆè®¡åˆ’
2. Worker æ˜¾ç¤º: "Ready to execute. Type /run"
3. Brain å‘é€: /run
4. Worker æ‰§è¡Œæ­¥éª¤...
5. å¯èƒ½å¤šæ¬¡å¾ªç¯:
   Worker: "Type /clear to reset"
   Brain: /clear
   Worker: "Type /run to continue"
   Brain: /run
6. æœ€ç»ˆå®Œæˆ:
   Worker: "All steps complete. Type /clear"
   Brain: /clear + å‘é€ä¸‹ä¸€ä¸ªä»»åŠ¡
```

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•ä¸­é€”åœæ­¢ï¼Ÿ

**A**: åœ¨è¿è¡Œ `start_auto.sh` çš„ç»ˆç«¯æŒ‰ `Ctrl+C`

### Q2: å¦‚ä½•ä¿®æ”¹ä»»åŠ¡åˆ—è¡¨ï¼Ÿ

**A**:
1. åœæ­¢ç³»ç»Ÿï¼ˆCtrl+Cï¼‰
2. ç¼–è¾‘ `tasks.md`
3. åˆ é™¤ `task_state.json`
4. é‡æ–°è¿è¡Œ `./start_auto.sh`

### Q3: Brain æ˜¯å¦ä¼šå ç”¨å¤§é‡ä¸Šä¸‹æ–‡ï¼Ÿ

**A**: ä¸ä¼šã€‚Brain æ¯æ¬¡éƒ½æ˜¯æ–°ä¼šè¯ï¼Œå¤„ç†å®Œç«‹å³é€€å‡ºï¼Œä¸Šä¸‹æ–‡å§‹ç»ˆå¹²å‡€ã€‚

### Q4: å¦‚æœ Brain è¯¯åˆ¤æ€ä¹ˆåŠï¼Ÿ

**A**: Brain ä¼šéªŒè¯ Worker æ˜¯å¦çœŸçš„åœæ­¢ï¼Œå¦‚æœè¯¯åˆ¤ä¼šç«‹å³é€€å‡ºã€‚

### Q5: å¦‚ä½•æŸ¥çœ‹ Brain çš„æ€è€ƒè¿‡ç¨‹ï¼Ÿ

**A**: Brain å¤„ç†æ—¶å¯ä»¥é™„åŠ æŸ¥çœ‹ï¼š
```bash
tmux attach -t brain-temp
# å¿«é€ŸæŒ‰ Ctrl+B, D åˆ†ç¦»ï¼ˆBrain å¾ˆå¿«å°±ä¼šé€€å‡ºï¼‰
```

### Q6: ä»»åŠ¡æ‰§è¡Œå¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿ

**A**:
- æŸ¥çœ‹ `task_results.md` äº†è§£é”™è¯¯
- æ‰‹åŠ¨é™„åŠ åˆ° Worker ä¿®å¤ï¼š`tmux attach -t claude-worker`
- æˆ–ä¿®æ”¹ `tasks.md` å’Œ `task_state.json` é‡æ–°å¼€å§‹

### Q7: å¦‚ä½•ä»ä¸­æ–­çš„åœ°æ–¹ç»§ç»­ï¼Ÿ

**A**:
1. æ£€æŸ¥ `task_state.json` ç¡®è®¤å½“å‰ä»»åŠ¡
2. å¦‚æœéœ€è¦ï¼Œæ‰‹åŠ¨ä¿®æ”¹ `current_task`
3. è¿è¡Œ `./start_auto.sh`ï¼ˆä¼šä½¿ç”¨ç°æœ‰çŠ¶æ€ï¼‰

---

## åœæ­¢ç³»ç»Ÿ

### æ­£å¸¸åœæ­¢

åœ¨è¿è¡Œ `start_auto.sh` çš„ç»ˆç«¯æŒ‰ `Ctrl+C`

### å¼ºåˆ¶åœæ­¢

```bash
# åœæ­¢ Python è„šæœ¬
pkill -f python_activator.py

# å…³é—­ Worker ä¼šè¯
tmux kill-session -t claude-worker

# å…³é—­ Brain ä¼šè¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
tmux kill-session -t brain-temp
```

---

## é«˜çº§ç”¨æ³•

### æ‰‹åŠ¨åˆå§‹åŒ–çŠ¶æ€

```bash
./init_state.sh
```

### åªå¯åŠ¨ Worker

```bash
tmux new -s claude-worker
cd /home/bfly/è¿ç»´/claude-triflow
claude
```

### æ‰‹åŠ¨æµ‹è¯• Brain

```bash
# åˆ›å»ºä¸´æ—¶ Brain
tmux new -s brain-temp
claude

# ç²˜è´´ brain_controller_prompt.md å†…å®¹
# è§‚å¯Ÿæ‰§è¡Œ
```

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

Python è„šæœ¬ä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š
- ğŸ§  æ¿€æ´» Brain
- âœ… Brain å¤„ç†å®Œæˆ
- âš ï¸  Worker å·²åœæ­¢
- ğŸ‰ æ‰€æœ‰ä»»åŠ¡å®Œæˆ

---

## æ•…éšœæ’æŸ¥

### Worker ä¸€ç›´ä¸å“åº”

1. é™„åŠ åˆ° Worker æŸ¥çœ‹ï¼š`tmux attach -t claude-worker`
2. æ£€æŸ¥æ˜¯å¦å¡åœ¨æŸä¸ªè¾“å…¥
3. æ‰‹åŠ¨è¾“å…¥å‘½ä»¤æˆ– Ctrl+C ä¸­æ–­

### Brain æ¿€æ´»å¤±è´¥

1. æ£€æŸ¥ `brain_controller_prompt.md` æ˜¯å¦å­˜åœ¨
2. ç¡®è®¤ claude å‘½ä»¤å¯ç”¨
3. æŸ¥çœ‹ Python è„šæœ¬é”™è¯¯è¾“å‡º

### ä»»åŠ¡è·³è¿‡äº†

æ£€æŸ¥ `task_state.json`ï¼Œç¡®è®¤ `current_task` æ˜¯å¦æ­£ç¡®ã€‚

---

## ç¤ºä¾‹è¾“å‡º

### Python è„šæœ¬è¾“å‡º

```
=== Claude TriFlow Python Activator ===
Worker ä¼šè¯: claude-worker
å·¥ä½œç›®å½•: /home/bfly/è¿ç»´/claude-triflow
æ£€æŸ¥é—´éš”: 3 ç§’
âœ… Worker ä¼šè¯å·²å°±ç»ª
ğŸš€ åˆå§‹åŒ–ï¼šæ¿€æ´» Brain å‘é€ç¬¬ä¸€ä¸ªä»»åŠ¡
ğŸ§  æ¿€æ´» Brain...
ç­‰å¾… Brain å¯åŠ¨... (10ç§’)
âœ… Brain æç¤ºè¯å·²å‘é€
ç­‰å¾… Brain å¤„ç†...
âœ… Brain å¤„ç†å®Œæˆ (8ç§’)
ğŸ—‘ï¸  Brain ä¼šè¯å·²å…³é—­
ç­‰å¾… Worker å¼€å§‹æ‰§è¡Œ...
ğŸ”„ å¼€å§‹ç›‘æ§å¾ªç¯...
âš ï¸  Worker å·²åœæ­¢ â†’ æ¿€æ´» Brain (ç¬¬ 1 æ¬¡)
ğŸ§  æ¿€æ´» Brain...
...
ğŸ‰ æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼ç›‘æ§ç»“æŸ
```

---

## ä¸‹ä¸€æ­¥

1. âœ… ç¼–è¾‘ `tasks.md` å‡†å¤‡ä»»åŠ¡
2. âœ… è¿è¡Œ `./start_auto.sh`
3. âœ… è§‚å¯Ÿæ‰§è¡Œè¿‡ç¨‹
4. âœ… æŸ¥çœ‹ `task_results.md` ç»“æœ

---

**ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼Œéšæ—¶å¯ä»¥å¼€å§‹ï¼** ğŸš€
